const config={url:"http://log.ktj.wankacn.com"};var CryptoJS=CryptoJS||function(t,e){var r={},i=r.lib={},n=function(){},s=i.Base={extend:function(t){n.prototype=this;var e=new n;return t&&e.mixIn(t),e.hasOwnProperty("init")||(e.init=function(){e.$super.init.apply(this,arguments)}),e.init.prototype=e,e.$super=this,e},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}},o=i.WordArray=s.extend({init:function(t,e){t=this.words=t||[],this.sigBytes=null!=e?e:4*t.length},toString:function(t){return(t||c).stringify(this)},concat:function(t){var e=this.words,r=t.words,i=this.sigBytes;if(t=t.sigBytes,this.clamp(),i%4)for(var n=0;n<t;n++)e[i+n>>>2]|=(r[n>>>2]>>>24-n%4*8&255)<<24-(i+n)%4*8;else if(65535<r.length)for(n=0;n<t;n+=4)e[i+n>>>2]=r[n>>>2];else e.push.apply(e,r);return this.sigBytes+=t,this},clamp:function(){var e=this.words,r=this.sigBytes;e[r>>>2]&=4294967295<<32-r%4*8,e.length=t.ceil(r/4)},clone:function(){var t=s.clone.call(this);return t.words=this.words.slice(0),t},random:function(e){for(var r=[],i=0;i<e;i+=4)r.push(4294967296*t.random()|0);return new o.init(r,e)}}),a=r.enc={},c=a.Hex={stringify:function(t){var e=t.words;t=t.sigBytes;for(var r=[],i=0;i<t;i++){var n=e[i>>>2]>>>24-i%4*8&255;r.push((n>>>4).toString(16)),r.push((15&n).toString(16))}return r.join("")},parse:function(t){for(var e=t.length,r=[],i=0;i<e;i+=2)r[i>>>3]|=parseInt(t.substr(i,2),16)<<24-i%8*4;return new o.init(r,e/2)}},u=a.Latin1={stringify:function(t){var e=t.words;t=t.sigBytes;for(var r=[],i=0;i<t;i++)r.push(String.fromCharCode(e[i>>>2]>>>24-i%4*8&255));return r.join("")},parse:function(t){for(var e=t.length,r=[],i=0;i<e;i++)r[i>>>2]|=(255&t.charCodeAt(i))<<24-i%4*8;return new o.init(r,e)}},h=a.Utf8={stringify:function(t){try{return decodeURIComponent(escape(u.stringify(t)))}catch(t){throw Error("Malformed UTF-8 data")}},parse:function(t){return u.parse(unescape(encodeURIComponent(t)))}},p=i.BufferedBlockAlgorithm=s.extend({reset:function(){this._data=new o.init,this._nDataBytes=0},_append:function(t){"string"==typeof t&&(t=h.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(e){var r=this._data,i=r.words,n=r.sigBytes,s=this.blockSize,a=n/(4*s);if(e=(a=e?t.ceil(a):t.max((0|a)-this._minBufferSize,0))*s,n=t.min(4*e,n),e){for(var c=0;c<e;c+=s)this._doProcessBlock(i,c);c=i.splice(0,e),r.sigBytes-=n}return new o.init(c,n)},clone:function(){var t=s.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0});i.Hasher=p.extend({cfg:s.extend(),init:function(t){this.cfg=this.cfg.extend(t),this.reset()},reset:function(){p.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){return t&&this._append(t),this._doFinalize()},blockSize:16,_createHelper:function(t){return function(e,r){return new t.init(r).finalize(e)}},_createHmacHelper:function(t){return function(e,r){return new f.HMAC.init(t,r).finalize(e)}}});var f=r.algo={};return r}(Math);!function(){var t=CryptoJS,e=t.lib.WordArray;t.enc.Base64={stringify:function(t){var e=t.words,r=t.sigBytes,i=this._map;t.clamp(),t=[];for(var n=0;n<r;n+=3)for(var s=(e[n>>>2]>>>24-n%4*8&255)<<16|(e[n+1>>>2]>>>24-(n+1)%4*8&255)<<8|e[n+2>>>2]>>>24-(n+2)%4*8&255,o=0;4>o&&n+.75*o<r;o++)t.push(i.charAt(s>>>6*(3-o)&63));if(e=i.charAt(64))for(;t.length%4;)t.push(e);return t.join("")},parse:function(t){var r=t.length,i=this._map;(n=i.charAt(64))&&(-1!=(n=t.indexOf(n))&&(r=n));for(var n=[],s=0,o=0;o<r;o++)if(o%4){var a=i.indexOf(t.charAt(o-1))<<o%4*2,c=i.indexOf(t.charAt(o))>>>6-o%4*2;n[s>>>2]|=(a|c)<<24-s%4*8,s++}return e.create(n,s)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),function(t){function e(t,e,r,i,n,s,o){return((t=t+(e&r|~e&i)+n+o)<<s|t>>>32-s)+e}function r(t,e,r,i,n,s,o){return((t=t+(e&i|r&~i)+n+o)<<s|t>>>32-s)+e}function i(t,e,r,i,n,s,o){return((t=t+(e^r^i)+n+o)<<s|t>>>32-s)+e}function n(t,e,r,i,n,s,o){return((t=t+(r^(e|~i))+n+o)<<s|t>>>32-s)+e}for(var s=CryptoJS,o=(c=s.lib).WordArray,a=c.Hasher,c=s.algo,u=[],h=0;64>h;h++)u[h]=4294967296*t.abs(t.sin(h+1))|0;c=c.MD5=a.extend({_doReset:function(){this._hash=new o.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(t,s){for(var o=0;16>o;o++){var a=t[c=s+o];t[c]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8)}o=this._hash.words;var c=t[s+0],h=(a=t[s+1],t[s+2]),p=t[s+3],f=t[s+4],_=t[s+5],d=t[s+6],l=t[s+7],g=t[s+8],y=t[s+9],m=t[s+10],v=t[s+11],k=t[s+12],S=t[s+13],w=t[s+14],B=t[s+15],x=e(x=o[0],P=o[1],b=o[2],C=o[3],c,7,u[0]),C=e(C,x,P,b,a,12,u[1]),b=e(b,C,x,P,h,17,u[2]),P=e(P,b,C,x,p,22,u[3]);x=e(x,P,b,C,f,7,u[4]),C=e(C,x,P,b,_,12,u[5]),b=e(b,C,x,P,d,17,u[6]),P=e(P,b,C,x,l,22,u[7]),x=e(x,P,b,C,g,7,u[8]),C=e(C,x,P,b,y,12,u[9]),b=e(b,C,x,P,m,17,u[10]),P=e(P,b,C,x,v,22,u[11]),x=e(x,P,b,C,k,7,u[12]),C=e(C,x,P,b,S,12,u[13]),b=e(b,C,x,P,w,17,u[14]),x=r(x,P=e(P,b,C,x,B,22,u[15]),b,C,a,5,u[16]),C=r(C,x,P,b,d,9,u[17]),b=r(b,C,x,P,v,14,u[18]),P=r(P,b,C,x,c,20,u[19]),x=r(x,P,b,C,_,5,u[20]),C=r(C,x,P,b,m,9,u[21]),b=r(b,C,x,P,B,14,u[22]),P=r(P,b,C,x,f,20,u[23]),x=r(x,P,b,C,y,5,u[24]),C=r(C,x,P,b,w,9,u[25]),b=r(b,C,x,P,p,14,u[26]),P=r(P,b,C,x,g,20,u[27]),x=r(x,P,b,C,S,5,u[28]),C=r(C,x,P,b,h,9,u[29]),b=r(b,C,x,P,l,14,u[30]),x=i(x,P=r(P,b,C,x,k,20,u[31]),b,C,_,4,u[32]),C=i(C,x,P,b,g,11,u[33]),b=i(b,C,x,P,v,16,u[34]),P=i(P,b,C,x,w,23,u[35]),x=i(x,P,b,C,a,4,u[36]),C=i(C,x,P,b,f,11,u[37]),b=i(b,C,x,P,l,16,u[38]),P=i(P,b,C,x,m,23,u[39]),x=i(x,P,b,C,S,4,u[40]),C=i(C,x,P,b,c,11,u[41]),b=i(b,C,x,P,p,16,u[42]),P=i(P,b,C,x,d,23,u[43]),x=i(x,P,b,C,y,4,u[44]),C=i(C,x,P,b,k,11,u[45]),b=i(b,C,x,P,B,16,u[46]),x=n(x,P=i(P,b,C,x,h,23,u[47]),b,C,c,6,u[48]),C=n(C,x,P,b,l,10,u[49]),b=n(b,C,x,P,w,15,u[50]),P=n(P,b,C,x,_,21,u[51]),x=n(x,P,b,C,k,6,u[52]),C=n(C,x,P,b,p,10,u[53]),b=n(b,C,x,P,m,15,u[54]),P=n(P,b,C,x,a,21,u[55]),x=n(x,P,b,C,g,6,u[56]),C=n(C,x,P,b,B,10,u[57]),b=n(b,C,x,P,d,15,u[58]),P=n(P,b,C,x,S,21,u[59]),x=n(x,P,b,C,f,6,u[60]),C=n(C,x,P,b,v,10,u[61]),b=n(b,C,x,P,h,15,u[62]),P=n(P,b,C,x,y,21,u[63]);o[0]=o[0]+x|0,o[1]=o[1]+P|0,o[2]=o[2]+b|0,o[3]=o[3]+C|0},_doFinalize:function(){var e=this._data,r=e.words,i=8*this._nDataBytes,n=8*e.sigBytes;r[n>>>5]|=128<<24-n%32;var s=t.floor(i/4294967296);for(r[15+(n+64>>>9<<4)]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),r[14+(n+64>>>9<<4)]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),e.sigBytes=4*(r.length+1),this._process(),r=(e=this._hash).words,i=0;4>i;i++)n=r[i],r[i]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8);return e},clone:function(){var t=a.clone.call(this);return t._hash=this._hash.clone(),t}}),s.MD5=a._createHelper(c),s.HmacMD5=a._createHmacHelper(c)}(Math),function(){var t,e=CryptoJS,r=(t=e.lib).Base,i=t.WordArray,n=(t=e.algo).EvpKDF=r.extend({cfg:r.extend({keySize:4,hasher:t.MD5,iterations:1}),init:function(t){this.cfg=this.cfg.extend(t)},compute:function(t,e){for(var r=(a=this.cfg).hasher.create(),n=i.create(),s=n.words,o=a.keySize,a=a.iterations;s.length<o;){c&&r.update(c);var c=r.update(t).finalize(e);r.reset();for(var u=1;u<a;u++)c=r.finalize(c),r.reset();n.concat(c)}return n.sigBytes=4*o,n}});e.EvpKDF=function(t,e,r){return n.create(r).compute(t,e)}}(),CryptoJS.lib.Cipher||function(t){var e=(_=CryptoJS).lib,r=e.Base,i=e.WordArray,n=e.BufferedBlockAlgorithm,s=_.enc.Base64,o=_.algo.EvpKDF,a=e.Cipher=n.extend({cfg:r.extend(),createEncryptor:function(t,e){return this.create(this._ENC_XFORM_MODE,t,e)},createDecryptor:function(t,e){return this.create(this._DEC_XFORM_MODE,t,e)},init:function(t,e,r){this.cfg=this.cfg.extend(r),this._xformMode=t,this._key=e,this.reset()},reset:function(){n.reset.call(this),this._doReset()},process:function(t){return this._append(t),this._process()},finalize:function(t){return t&&this._append(t),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(t){return{encrypt:function(e,r,i){return("string"==typeof r?d:f).encrypt(t,e,r,i)},decrypt:function(e,r,i){return("string"==typeof r?d:f).decrypt(t,e,r,i)}}}});e.StreamCipher=a.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var c=_.mode={},u=function(t,e,r){var i=this._iv;i?this._iv=void 0:i=this._prevBlock;for(var n=0;n<r;n++)t[e+n]^=i[n]},h=(e.BlockCipherMode=r.extend({createEncryptor:function(t,e){return this.Encryptor.create(t,e)},createDecryptor:function(t,e){return this.Decryptor.create(t,e)},init:function(t,e){this._cipher=t,this._iv=e}})).extend();h.Encryptor=h.extend({processBlock:function(t,e){var r=this._cipher,i=r.blockSize;u.call(this,t,e,i),r.encryptBlock(t,e),this._prevBlock=t.slice(e,e+i)}}),h.Decryptor=h.extend({processBlock:function(t,e){var r=this._cipher,i=r.blockSize,n=t.slice(e,e+i);r.decryptBlock(t,e),u.call(this,t,e,i),this._prevBlock=n}}),c=c.CBC=h,h=(_.pad={}).Pkcs7={pad:function(t,e){for(var r,n=(r=(r=4*e)-t.sigBytes%r)<<24|r<<16|r<<8|r,s=[],o=0;o<r;o+=4)s.push(n);r=i.create(s,r),t.concat(r)},unpad:function(t){t.sigBytes-=255&t.words[t.sigBytes-1>>>2]}},e.BlockCipher=a.extend({cfg:a.cfg.extend({mode:c,padding:h}),reset:function(){a.reset.call(this);var t=(e=this.cfg).iv,e=e.mode;if(this._xformMode==this._ENC_XFORM_MODE)var r=e.createEncryptor;else r=e.createDecryptor,this._minBufferSize=1;this._mode=r.call(e,this,t&&t.words)},_doProcessBlock:function(t,e){this._mode.processBlock(t,e)},_doFinalize:function(){var t=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){t.pad(this._data,this.blockSize);var e=this._process(!0)}else e=this._process(!0),t.unpad(e);return e},blockSize:4});var p=e.CipherParams=r.extend({init:function(t){this.mixIn(t)},toString:function(t){return(t||this.formatter).stringify(this)}}),f=(c=(_.format={}).OpenSSL={stringify:function(t){var e=t.ciphertext;return((t=t.salt)?i.create([1398893684,1701076831]).concat(t).concat(e):e).toString(s)},parse:function(t){var e=(t=s.parse(t)).words;if(1398893684==e[0]&&1701076831==e[1]){var r=i.create(e.slice(2,4));e.splice(0,4),t.sigBytes-=16}return p.create({ciphertext:t,salt:r})}},e.SerializableCipher=r.extend({cfg:r.extend({format:c}),encrypt:function(t,e,r,i){i=this.cfg.extend(i);var n=t.createEncryptor(r,i);return e=n.finalize(e),n=n.cfg,p.create({ciphertext:e,key:r,iv:n.iv,algorithm:t,mode:n.mode,padding:n.padding,blockSize:t.blockSize,formatter:i.format})},decrypt:function(t,e,r,i){return i=this.cfg.extend(i),e=this._parse(e,i.format),t.createDecryptor(r,i).finalize(e.ciphertext)},_parse:function(t,e){return"string"==typeof t?e.parse(t,this):t}})),_=(_.kdf={}).OpenSSL={execute:function(t,e,r,n){return n||(n=i.random(8)),t=o.create({keySize:e+r}).compute(t,n),r=i.create(t.words.slice(e),4*r),t.sigBytes=4*e,p.create({key:t,iv:r,salt:n})}},d=e.PasswordBasedCipher=f.extend({cfg:f.cfg.extend({kdf:_}),encrypt:function(t,e,r,i){return r=(i=this.cfg.extend(i)).kdf.execute(r,t.keySize,t.ivSize),i.iv=r.iv,(t=f.encrypt.call(this,t,e,r.key,i)).mixIn(r),t},decrypt:function(t,e,r,i){return i=this.cfg.extend(i),e=this._parse(e,i.format),r=i.kdf.execute(r,t.keySize,t.ivSize,e.salt),i.iv=r.iv,f.decrypt.call(this,t,e,r.key,i)}})}(),function(){for(var t=CryptoJS,e=t.lib.BlockCipher,r=t.algo,i=[],n=[],s=[],o=[],a=[],c=[],u=[],h=[],p=[],f=[],_=[],d=0;256>d;d++)_[d]=128>d?d<<1:d<<1^283;var l=0,g=0;for(d=0;256>d;d++){var y=(y=g^g<<1^g<<2^g<<3^g<<4)>>>8^255&y^99;i[l]=y,n[y]=l;var m=_[l],v=_[m],k=_[v],S=257*_[y]^16843008*y;s[l]=S<<24|S>>>8,o[l]=S<<16|S>>>16,a[l]=S<<8|S>>>24,c[l]=S,S=16843009*k^65537*v^257*m^16843008*l,u[y]=S<<24|S>>>8,h[y]=S<<16|S>>>16,p[y]=S<<8|S>>>24,f[y]=S,l?(l=m^_[_[_[k^m]]],g^=_[_[g]]):l=g=1}var w=[0,1,2,4,8,16,32,64,128,27,54];r=r.AES=e.extend({_doReset:function(){for(var t=(r=this._key).words,e=r.sigBytes/4,r=4*((this._nRounds=e+6)+1),n=this._keySchedule=[],s=0;s<r;s++)if(s<e)n[s]=t[s];else{var o=n[s-1];s%e?6<e&&4==s%e&&(o=i[o>>>24]<<24|i[o>>>16&255]<<16|i[o>>>8&255]<<8|i[255&o]):(o=i[(o=o<<8|o>>>24)>>>24]<<24|i[o>>>16&255]<<16|i[o>>>8&255]<<8|i[255&o],o^=w[s/e|0]<<24),n[s]=n[s-e]^o}for(t=this._invKeySchedule=[],e=0;e<r;e++)s=r-e,o=e%4?n[s]:n[s-4],t[e]=4>e||4>=s?o:u[i[o>>>24]]^h[i[o>>>16&255]]^p[i[o>>>8&255]]^f[i[255&o]]},encryptBlock:function(t,e){this._doCryptBlock(t,e,this._keySchedule,s,o,a,c,i)},decryptBlock:function(t,e){var r=t[e+1];t[e+1]=t[e+3],t[e+3]=r,this._doCryptBlock(t,e,this._invKeySchedule,u,h,p,f,n),r=t[e+1],t[e+1]=t[e+3],t[e+3]=r},_doCryptBlock:function(t,e,r,i,n,s,o,a){for(var c=this._nRounds,u=t[e]^r[0],h=t[e+1]^r[1],p=t[e+2]^r[2],f=t[e+3]^r[3],_=4,d=1;d<c;d++){var l=i[u>>>24]^n[h>>>16&255]^s[p>>>8&255]^o[255&f]^r[_++],g=i[h>>>24]^n[p>>>16&255]^s[f>>>8&255]^o[255&u]^r[_++],y=i[p>>>24]^n[f>>>16&255]^s[u>>>8&255]^o[255&h]^r[_++];f=i[f>>>24]^n[u>>>16&255]^s[h>>>8&255]^o[255&p]^r[_++],u=l,h=g,p=y}l=(a[u>>>24]<<24|a[h>>>16&255]<<16|a[p>>>8&255]<<8|a[255&f])^r[_++],g=(a[h>>>24]<<24|a[p>>>16&255]<<16|a[f>>>8&255]<<8|a[255&u])^r[_++],y=(a[p>>>24]<<24|a[f>>>16&255]<<16|a[u>>>8&255]<<8|a[255&h])^r[_++],f=(a[f>>>24]<<24|a[u>>>16&255]<<16|a[h>>>8&255]<<8|a[255&p])^r[_++],t[e]=l,t[e+1]=g,t[e+2]=y,t[e+3]=f},keySize:8});t.AES=e._createHelper(r)}(),CryptoJS.pad.ZeroPadding={pad:function(t,e){var r=4*e;t.clamp(),t.sigBytes+=r-(t.sigBytes%r||r)},unpad:function(t){for(var e=t.words,r=t.sigBytes-1;!(e[r>>>2]>>>24-r%4*8&255);)r--;t.sigBytes=r+1}};import storage from"@system.storage";import nativeFetch from"@system.fetch";import device from"@system.device";import network from"@system.network";import account from"@service.account";import shortcut from"@system.shortcut";import md5 from"md5";import app from"@system.app";import router from"@system.router";import APP_CONFIG from"./statistics.config";!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.APP_STATISTICS=e()}(this,function(){"use strict";function t(t){let e="";for(let r in t)e+=r+"="+t[r]+"&";return e=e.substring(0,e.length-1)}function e(t){return"string"==typeof t?t:JSON.stringify(t)}function r(t,e){let r=md5("huanju@quickapp"+e).substring(16).toLowerCase(),i=CryptoJS.enc.Latin1.parse(r),n=CryptoJS.enc.Latin1.parse("2018080716102000");return CryptoJS.AES.encrypt(t,i,{iv:n,mode:CryptoJS.mode.CBC,padding:CryptoJS.pad.ZeroPadding}).toString()}function i(){return(268435456*(1+Math.random())|0).toString(16)}function n(t){let e=Date.now()+i()+i()+(t||i());return md5(e)}function s(t){let e=/^[0-9a-zA-Z_\u4e00-\u9fa5]{0,255}$/,r=0;if("string"==typeof t&&e.test(t))return!0;if(function(t){if("object"!=typeof t||null==t)return!1;if(null===Object.getPrototypeOf(t))return!0;let e=t;for(;null!==Object.getPrototypeOf(e);)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e}(t)){for(let i in t){let n=t[i];if("string"!=typeof i&&"number"!=typeof i||!/^[0-9a-zA-Z_\u4e00-\u9fa5]{1,255}$/.test(i))return!1;if("string"!=typeof n&&"number"!=typeof n||!e.test(n))return!1;r++}return!(r>100)}return!1}const o={get:function(t){let{url:e,timeout:r}=t,i=new Promise((t,r)=>{try{nativeFetch.fetch({url:config.url+e,success:function(e){t(e)},fail:function(e,r){t(e)}})}catch(t){}}),n=new Promise((t,e)=>{setTimeout(()=>{t({code:204,massage:"Request timed out"})},r||3e3)});return Promise.race([n,i])}};function a(t){return o.get({url:"/a.gif?"+t})}function c(...t){return new Promise((e,r)=>{try{storage.set({key:t[0],value:t[1]||"",success:function(t){e(!0)},fail:function(t){e(!1)}})}catch(t){e(!1)}})}function u(t){return new Promise((e,r)=>{try{storage.get({key:t,success:function(t){e(t)},fail:function(t,r){e(!1)}})}catch(t){e(!1)}})}const h={deviceIds:()=>new Promise((t,e)=>{try{device.getId({type:["device","mac"],success:function(e){t(e)},fail:function(e,r){t({})}})}catch(e){t({})}}),getUserId:()=>new Promise((t,e)=>{try{device.getUserId({success:function(e){t(e)},fail:function(e,r){t({})}})}catch(e){t({})}}),deviceInfos:()=>new Promise((t,e)=>{try{device.getInfo({success:function(e){t(e)},fail:function(){t({})}})}catch(e){t({})}}),netType:()=>new Promise((t,e)=>{try{network.getType({success:function(e){t(e)},fail:function(){t({})}})}catch(e){t({})}}),has_shortcut:()=>new Promise((t,e)=>{try{shortcut.hasInstalled({success:function(e){t({has_icon:e?1:0})},fail:function(){t({has_icon:0})}})}catch(e){t({has_icon:0})}})},p={sdk_version:"1.3.1.0",debug:0},f="_SD_BD_CUID_",_="_SD_BD_ERR_MSG_INFO_",d=3e4,l={has_init:!1,has_cuid_storage:!1,has_request_id_storage:!1,has_open_log:!1};const g={device:(t,i)=>({package:t.package||"",channel:t.channel||"",name:t.name||"",svr:t.versionName||"",client_id:r(t.device||"",i),info_ma:r(t.mac||"",i),os_id:r(t.userId||"",i),make:(t.brand||"").toLowerCase(),manufacturer:(t.manufacturer||"").toLowerCase(),model:(t.model||"").toLowerCase(),product:(t.product||"").toLowerCase(),os_type:t.osType||"",ovr:t.osVersionName||"",pla_ver:t.platformVersionName||"",lan:(t.language||"").toLowerCase(),region:(t.region||"").toLowerCase(),px:`${t.screenWidth||""}*${t.screenHeight||""}`,net:t.type||"",has_icon:t.has_icon||0,source:t.source||"",extra:e(t.extra||"")}),page:(t={})=>({page_name:"",page_path:"",sta_time:"",end_time:"",duration:"",is_entry:0,...t}),public:t=>({app_id:APP_CONFIG.app_key||"",cuid:t.cuid,req_id:t.req,en_code:"cuid",action:2})},y=new class{constructor(){this.state={is_entry:1,cuid:"",req:"",log_list:[],data:null,page:null},this.init=this.init.bind(this),this.page_stat=this.page_stat.bind(this),this.page_end=this.page_end.bind(this),this.merge_datas=this.merge_datas.bind(this),this.save_to_queue=this.save_to_queue.bind(this),this.handle_submit=this.handle_submit.bind(this),this.send_queue=this.send_queue.bind(this),this.event_log=this.event_log.bind(this),this.err_report=this.err_report.bind(this),this.isReStart=this.isReStart.bind(this),this.reStart=this.reStart.bind(this)}init(t){l.has_init=!0;let r={},s=t||{_def:{}};s._def=s._def||{manifest:{}};let o,{_def:{manifest:a}}=s;try{o=app.getInfo()}catch(t){let r={err_msg:e(t.stack)||"",err_site:"app.getInfo"};y.err_report(r)}r.package=a.package||o.packageName,r.versionName=a.versionName||o.versionName,r.minPlatformVersion=a.minPlatformVersion||"",r.name=a.name||o.name,r.source=o.source&&o.source.type,r.extra=o.source&&o.source.extra;try{r.channel=account.getProvider()}catch(t){let r={err_msg:e(t.stack)||"",err_site:"account.getProvider"};y.err_report(r)}Promise.all([h.deviceInfos(),h.getUserId(),h.netType(),h.has_shortcut()]).then(t=>{let e=Object.assign(r,...t),s={};u(f).then(t=>{t?s.cuid=t:(s.cuid=function(t){let e=t||i();return md5(Date.now()+"-"+i()+"-"+i()+"-"+i()+"-"+e)}(e.userId||""),c(f,s.cuid).then(t=>{t&&(l.has_cuid_storage=!0)})),this.state.cuid=s.cuid,s.req=this.state.req=n(s.cuid),this.state.data={...g.device(e,this.state.cuid),...g.public(s)}})})}page_stat(t){let r,i;try{let t=router.getState()||{};r=t.name,i=t.path}catch(t){let r={err_msg:e(t.stack)||"",err_site:"router.getState"};y.err_report(r)}try{this.isReStart(r)&&this.reStart()}catch(t){let r={err_msg:e(t.stack)||"",err_site:"computed reStart"};y.err_report(r)}this.state.page=g.page({sta_time:Date.now(),page_name:r||"",page_path:i||"",is_entry:this.state.is_entry||0}),this.state.is_entry=0,l.has_open_log=!0}page_end(t){if(!this.state.cuid||!this.state.data)return;let e=Date.now();if(this.state.page)this.state.page.duration=e-this.state.page.sta_time,this.state.page.end_time=e,this.handle_submit();else{let t={err_msg:`this.state.page is ${this.state.page}`,err_site:"get_page_data"};y.err_report(t)}}isReStart(t){let e=this.state.page||{page_name:"",end_time:0},r=Date.now()-e.end_time;return t&&t===e.page_name&&r>=d}reStart(){this.is_entry=this.state.is_entry=1,this.req=this.state.data.req_id=n(this.state.cuid)}merge_datas(){return{...this.state.data||{},...this.state.page||{},...p}}handle_submit(e={}){let r=t({...this.merge_datas(),...e});a(r).then(t=>{200==t.code?this.send_queue():this.save_to_queue(r)}).catch(t=>{this.save_to_queue(r)})}save_to_queue(t){let e=this.state.log_list&&this.state.log_list.length;return e&&e<50&&this.state.log_list.push(`${t}&retry=1`),this.state.log_list}send_queue(){let t=[...this.state.log_list];this.state.log_list=[],t.forEach(t=>{a(t).then(e=>{200!=e.code&&this.save_to_queue(t)}).catch(e=>{this.save_to_queue(t)})})}event_log(t){this.state.req?this.handle_submit({...t,action:"3"}):console.error("event err:Please execute the “track_event” after the initialization is complete")}err_report(r){let i=t({...this.merge_datas(),...r,app_id:APP_CONFIG.app_key||"",action:"9"});u(_).then(t=>{let r=t,n=(new Date).getDate(),s=0;if(r)try{r=JSON.parse(r)&&JSON.parse(r)}catch(t){r={day:n,len:0}}(r&&r.day)==n&&(s=Number(r.len)+1),s<=50&&function(t){return o.get({url:"/e.gif?"+t})}(i).then(t=>{c(_,e({day:n,len:s})).then()})}).catch()}};const m={open_app(t){try{if(!APP_CONFIG.app_key)return void console.error("Not configured app_key!");y.init(t)}catch(t){let r={err_msg:e(t.stack)||"",err_site:"open_app"};y.err_report(r)}},page_show(t){try{l.has_init&&y.page_stat(t)}catch(t){let r={err_msg:e(t.stack)||"",err_site:"page_show"};y.err_report(r)}},page_hide(t){try{l.has_init&&l.has_open_log&&y.page_end(t)}catch(t){let r={err_msg:e(t.stack)||"",err_site:"open_app"};y.err_report(r)}l.has_open_log=!1},track_event(t,r){try{if(!APP_CONFIG.app_key)return void console.error("Not configured app_key!");let i=null==r?"":r;if(!function(t){return"string"==typeof t&&""!==t&&/^[0-9a-zA-Z_\u4e00-\u9fa5]{1,255}$/.test(t)}(t))return void console.error('"event error": please check track_event id. id should be "string" and not null.');if(!s(i))return void console.error('"event error":  please check track_event parameter. parameter should be "string" or "object"');y.event_log({ev_id:t,ev_args:"string"==typeof i?i:e(i)})}catch(t){let r={err_msg:e(t.stack)||"",err_site:"track_event"};y.err_report(r)}}},v=global.__proto__||global;return v.APP_STATISTICS={app_sta_init:m.open_app,page_show:m.page_show,page_hide:m.page_hide,track_event:m.track_event},v.Custom_page=function(t){let e=t.onShow,r=t.onHide;return t.onShow=function(){m.page_show(this),e&&e.call(this)},t.onHide=function(){m.page_hide(this),r&&r.call(this)},t},{app_sta_init:m.open_app,page_show:m.page_show,page_hide:m.page_hide,track_event:m.track_event}});